---
layout: post
title: "acts_as_audited"
id: 4cf5b681dabe9d2c610006b3
updated: 2012-06-05T10:31:20-04:00
date: 2006-07-21T04:00:00-04:00
categories: 
- acts_as_audited
- plugin
- popular
- rails
- ruby
excerpt: ""
---

+*NOTE:* This article is out of date. Visit the "project on Github":http://github.com/collectiveidea/acts_as_audited or the "mailing list":http://groups.google.com/group/acts_as_audited for up-to-date information.+

<code>acts_as_audited</code> is an Active Record plugin that logs all modifications to your models in an <code>audits</code> table. It uses a polymorphic association to store an audit record for any of the model objects that you wish to have audited.  The audit log stores the model that the change was on, the "action" (create, update, destroy), a serialzied hash of the changes, and optionally the user that performed the action.

h3. Auditing in Rails

If you're using acts_as_audited within Rails, you can simply declare which models should be audited.  acts_as_audited can also automatically record the user that made the change if your controller has a <code>current_user</code> method.

<source:ruby>
class ApplicationController < ActionController::Base
  audit User, List, Item
protected
  def current_user
    @user ||= User.find(session[:user])
  end
end
</source>

h3. Caveats

<del>Auditing with user support depends on Rails' caching mechanisms, therefore auditing isn't enabled during development mode. To test that auditing is working, start up your app in production mode, or change the following options in config/environments/development.rb:

<source:ruby>
config.cache_classes = true
config.action_controller.perform_caching = true
</source>
</del>
<ins>"This has been fixed.":http://opensoul.org/2008/10/13/acts_as_audited-in-development</ins>

h3. Customizing

To get auditing outside of Rails, or to customize which fields are audited within Rails, you can explicitly declare <code>acts_as_audited</code> on your models. The <code>:except</code> option allows you to specify one or more attributes that you don't want to be saved in the audit log.

<source:ruby>
class User < ActiveRecord::Base
  acts_as_audited :except => [:password, :credit_card_number]
end
</source>

h3. Installation

You can grab the plugin by running:

<filter:jscode>
script/plugin install git://github.com/collectiveidea/acts_as_audited.git
</source>

Run the migration generator and migrate to add the audits table.

<filter:jscode>
script/generate audited_migration add_audits_table
rake db:migrate
</source>

h3. Upgrading

Those upgrading from version 0.2 need to add 2 fields the audits table:

<filter:jscode>
add_column :audits, :user_type, :string
add_column :audits, :username, :string
</source>
